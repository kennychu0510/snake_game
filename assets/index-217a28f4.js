var m=Object.defineProperty;var b=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var o=(e,t,n)=>(b(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const h of r)if(h.type==="childList")for(const x of h.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function n(r){const h={};return r.integrity&&(h.integrity=r.integrity),r.referrerpolicy&&(h.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?h.credentials="include":r.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function c(r){if(r.ep)return;r.ep=!0;const h=n(r);fetch(r.href,h)}})();const f=300,u=400,s=20,l=u/s,d=f/s;var i=(e=>(e[e.RIGHT=0]="RIGHT",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.UP=3]="UP",e))(i||{});const p=20;class T{constructor(){o(this,"rows",f/s);o(this,"columns",u/s)}draw(t){t.strokeStyle="grey";for(let n=0;n<this.rows*s;n+=s)for(let c=0;c<this.columns*s;c+=s)t.strokeRect(n,c,s,s)}}class L{constructor(t,n,c){o(this,"ctx");o(this,"x",Math.ceil(Math.random()*d));o(this,"y",Math.ceil(Math.random()*l));this.ctx=t;let r=!1;do this.spawn(),r=this.checkClash(n,c);while(r)}draw(){this.ctx.fillStyle="lime",this.ctx.fillRect(this.x*s,this.y*s,s,s)}spawn(){this.x=Math.floor(Math.random()*d),this.y=Math.floor(Math.random()*l)}checkClash(t,n){if(t.x===this.x&&t.y===this.y)return!0;for(let c of n)if(c.x===this.x&&c.y===this.y)return!0;return!1}}class v{constructor(t){o(this,"length",2);o(this,"color","red");o(this,"head",{x:Math.floor(d/2),y:l/2});o(this,"body");o(this,"ctx");o(this,"direction");o(this,"tick",0);o(this,"food");o(this,"alive",!0);this.ctx=t,this.direction=i.RIGHT,this.body=[{x:this.head.x-1,y:this.head.y}],this.food=new L(t,this.head,this.body)}draw(){this.food.draw(),this.ctx.fillStyle=this.color,this.tick++,this.ctx.fillRect(this.head.x*s,this.head.y*s,s,s);for(let t of this.body)this.ctx.fillRect(t.x*s,t.y*s,s,s);this.tick%p===0&&this.alive&&this.update()}update(){if(this.checkCollision()){this.alive=!1;return}switch(this.body.unshift({x:this.head.x,y:this.head.y}),this.body=this.body.slice(0,this.length-1),this.direction){case i.RIGHT:this.head.x===d-1?this.head.x=0:this.head.x+=1;break;case i.DOWN:this.head.y===l-1?this.head.y=0:this.head.y+=1;break;case i.LEFT:this.head.x===0?this.head.x=d-1:this.head.x-=1;break;case i.UP:this.head.y===0?this.head.y=l-1:this.head.y-=1;break}this.head.x===this.food.x&&this.head.y===this.food.y&&(this.food.spawn(),this.length++,this.update())}changeDirection(t){this.direction===i.RIGHT&&t===i.LEFT||this.direction===i.LEFT&&t===i.RIGHT||this.direction===i.UP&&t===i.DOWN||this.direction===i.DOWN&&t===i.UP||(this.direction=t)}checkCollision(){for(let t of this.body)if(t.x===this.head.x&&t.y===this.head.y)return!0;return!1}}class D{constructor(t){o(this,"ctx");o(this,"snake");o(this,"background",new T);this.ctx=t,this.snake=new v(this.ctx)}draw(){this.snake.draw(),this.background.draw(this.ctx),this.snake.alive||(this.ctx.font="24px serif",this.ctx.textAlign="center",this.ctx.fillStyle="white",this.ctx.fillText("You are dead",f/2,u/2))}}function y(e){const t=document.querySelector(e);if(!t)throw new Error(e+" not found");return t}const k=y("canvas"),U=y("#left-button"),E=y("#right-button"),S=y("#down-button"),G=y("#up-button"),w=k.getContext("2d");k.width=f;k.height=u;window.devicePixelRatio=2;const a=new D(w);function g(){P(w),a.draw(),requestAnimationFrame(g)}function P(e){e.clearRect(0,0,f,u)}g();document.addEventListener("keydown",e=>{switch(e.key){case"a":case"ArrowLeft":a.snake.changeDirection(i.LEFT);break;case"s":case"ArrowDown":a.snake.changeDirection(i.DOWN);break;case"d":case"ArrowRight":a.snake.changeDirection(i.RIGHT);break;case"w":case"ArrowUp":a.snake.changeDirection(i.UP);break}});U.addEventListener("click",()=>{a.snake.changeDirection(i.LEFT)});E.addEventListener("click",()=>{a.snake.changeDirection(i.RIGHT)});S.addEventListener("click",()=>{a.snake.changeDirection(i.DOWN)});G.addEventListener("click",()=>{a.snake.changeDirection(i.UP)});
